---
title: "Fernanda Herbst"
format: html
editor: visual
---

```{r}
#| label: load-packages
#| include: false

library(tidyverse)
library(WDI)
library(ggplot2)
library(dplyr)
library(scales)


options(scipen = 999) # REMOVER A NOT. CIENT.

 
#DADOS EM PAINEL

elet<- WDI(country = "all",indicator = "EG.ELC.ACCS.ZS")

# CORTE TRANSVERSAL

elet2023 <- WDI(country = "all", indicator = "EG.ELC.ACCS.ZS", start ="2023", end = "2023")

elet2022 <- WDI(country = "all", indicator = "EG.ELC.ACCS.ZS", start ="2022", end = "2022")


# S√âRIE TEMPORAL

eletbr <-  WDI(country = "BR", indicator = "EG.ELC.ACCS.ZS")
```

## ACESSO √Å ELETRICIDADE (% DA POPULA√á√ÉO)

A vari√°vel **EG.ELC.ACCS.ZS**, utilizada pelo Banco Mundial, representa a **porcentagem da popula√ß√£o com acesso √† eletricidade** em um determinado pa√≠s. Ela indica o n√≠vel de cobertura da infraestrutura el√©trica, sendo fundamental para avaliar o desenvolvimento social, econ√¥mico e tecnol√≥gico de uma na√ß√£o. Quanto mais pr√≥ximo de 100%, maior a propor√ß√£o de habitantes com acesso √† energia el√©trica ‚Äì um recurso essencial para qualidade de vida, educa√ß√£o, sa√∫de e crescimento econ√¥mico.

## GR√ÅFICO DE DADOS EM PAINEL

O gr√°fico apresenta a evolu√ß√£o do acesso √† eletricidade (% da popula√ß√£o) em pa√≠ses selecionados entre os anos de 1990 e 2023.

A an√°lise mostra que Alemanha, Argentina e Estados Unidos j√° apresentavam altos n√≠veis de acesso √† eletricidade em 1990, todos acima de 90%, alcan√ßando 100% em 2020 e mantendo esse patamar em 2023.

Em contrapartida, Mo√ßambique e Sud√£o do Sul apresentam um cen√°rio de acesso muito mais limitado. Mo√ßambique teve um crescimento gradual, saindo de um patamar muito baixo em 2000 para cerca de 40% em 2023. O Sud√£o do Sul, inclu√≠do a partir de 2010, mostra acesso extremamente baixo e com pouca evolu√ß√£o at√© 2023.

Esse comparativo evidencia a desigualdade no acesso √† eletricidade entre pa√≠ses desenvolvidos e em desenvolvimento, especialmente em regi√µes da √Åfrica subsaariana, ressaltando a necessidade de investimentos em infraestrutura energ√©tica nesses pa√≠ses.

```{r}
#| label: graficodadosempainel
#| warning: false
#| echo: false

# Definindo os anos e as abrevia√ß√µes
anos_desejados <- c(1990, 2000, 2010, 2020, 2023)

  abrevia_pais <- c(
    "Brazil" = "BRA",
    "United States" = "EUA",
    "Argentina" = "ARG",
    "Germany" = "ALE",
    "South Sudan" = "SDS",
    "Mozambique" = "MO√á"
  )

elet_plot <- elet 


paises_interesse <- names(abrevia_pais)

elet_plot <- elet |>
  filter(year %in% anos_desejados, 
         country %in% paises_interesse,
         !is.na(EG.ELC.ACCS.ZS)) %>%
  mutate(
    pais_abrev = abrevia_pais[country],
    cor_personalizada = case_when(
      country == "Brasil" ~ "red",
      country == "United States" ~ "#457B9D",
      country == "Germany" ~ "#A8DADC",
      country == "South Sudan" ~ "#A8DADC",
      country == "Mozambique" ~ "#A8DADC",
      country == "Argentina" ~ "#A8DADC",
    )
  )

# Aplicando filtros e abrevia√ß√µes
elet_plot <- elet|>
  filter(year %in% anos_desejados) |>
  mutate(
    pais_abrev = abrevia_pais[country],
    cor_personalizada = case_when(
      country == "Brazil" ~ "red",
      country == "United States" ~ "#457B9D",
      country == "Germany" ~ "#A8DADC",
      country == "South Sudan" ~ "#A8DADC",
      country == "Mozambique" ~ "#A8DADC",
      country == "Argentina" ~ "#A8DADC",
    )
  )

ggplot(elet_plot, aes(x = factor(year), y = EG.ELC.ACCS.ZS, fill = cor_personalizada)) +
  geom_col(aes(group = pais_abrev), 
           position = position_dodge(width = 0.8), width = 0.7) +
  geom_text(aes(label = pais_abrev, group = pais_abrev),
            position = position_dodge(width = 0.8),
            vjust = -0.7, size = 2, fontface = "bold", color = "black") +
  scale_fill_identity() +
  scale_y_continuous(limits = c(0, 110), expand = expansion(mult = c(0, 0.05))) +
  labs(
    title = "\u26A1 Acesso √† Eletricidade (% da Popula√ß√£o) \u26A1",
    subtitle = "Comparativo entre pa√≠ses selecionados (1990‚Äì2023)",
    x = "Ano",
    y = "Acesso (%)"
  ) +
  theme_minimal(base_family = "sans") +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5, color = "#1D3557"),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "#457B9D"),
    axis.title = element_text(size = 10, face = "bold"),
    axis.text = element_text(size = 10),
    legend.position = "none",
    panel.grid.major = element_line(color = "gray85"),
    panel.grid.minor = element_blank(),
    axis.line = element_line(color = "black"),
    plot.background = element_rect(fill = "white", color = NA)
  )


```

```         
```

## GR√ÅFICO DE DADOS DE CORTE TRANSVERSAL

Este gr√°fico apresenta o acesso √† eletricidade em 30 pa√≠ses (ou agrupamentos) em 2023, destacando o Brasil em vermelho. Analisando o gr√°fico podemos destacar os seguintes pontos:\

-   A maioria dos pa√≠ses ou regi√µes listadas no topo do gr√°fico apresenta 100% de acesso √† eletricidade, como Uni√£o Europeia, Am√©rica do Norte, Europa Central e outros blocos econ√¥micos avan√ßados.
-   O Brasil aparece em destaque com 99% de acesso √† eletricidade, ligeiramente abaixo dos pa√≠ses com cobertura total, indicando um alto n√≠vel de universaliza√ß√£o.
-   J√° os pa√≠ses com menor acesso concentram-se majoritariamente na √Åfrica Subsaariana. O Sud√£o do Sul, por exemplo, tem o menor √≠ndice, com apenas 5,4% da popula√ß√£o com acesso √† eletricidade.
-   A desigualdade no acesso √© evidente: enquanto alguns pa√≠ses t√™m cobertura universal, outros apresentam taxas abaixo de 20%, o que evidencia desafios de infraestrutura e desenvolvimento em algumas regi√µes.

```{r}
#| label: graficocortetransversal
#| warning: false 
#| echo: false  

# Carregar pacotes necess√°rios
library(ggplot2)
library(dplyr)
library(scales)

# ========================
# PREPARA√á√ÉO DOS DADOS
# ========================

elet2023_clean <- elet %>%
  filter(year == 2023) %>%
  select(country, EG.ELC.ACCS.ZS)

# Adicionar coluna de status para categoriza√ß√£o visual
elet2023_clean <- elet2023_clean |>
  mutate(
    status_eletricidade = case_when(
      country == "Brazil" ~ "Brasil",
      EG.ELC.ACCS.ZS >= 100 ~ "100% de Acesso",
      TRUE ~ "Acesso Parcial"
    )
  )

# Selecionar 14 pa√≠ses com 100% de acesso √† eletricidade (excluindo o Brasil)
top100 <- elet2023_clean |>
  filter(EG.ELC.ACCS.ZS >= 100, country != "Brazil") %>%
  arrange(desc(EG.ELC.ACCS.ZS)) %>%
  slice(1:14)

# Selecionar 15 pa√≠ses com menor acesso
bottom_poor <- elet2023_clean |>
  filter(EG.ELC.ACCS.ZS < 100) %>%
  arrange(EG.ELC.ACCS.ZS) %>%
  slice(1:15)

# Combinar os pa√≠ses selecionados com o Brasil
elet30 <- bind_rows(top100, bottom_poor, elet2023_clean %>% filter(country == "Brazil"))

# Traduzir nomes dos pa√≠ses para o portugu√™s
elet30 <- elet30 |>
  mutate(country_pt = recode(country,
    "Post-demographic dividend" = "P√≥s-dividendo demogr√°fico",
    "North Am√©rica" = "N. Am√©rica",
    "European Union" = "Uni√£o Europeia",
    "Europe & Central Asia (IDA & IBRD countries)" = "Europa & √Åsia Central (pa√≠ses IDA & IBRD)",
    "Europe & Central Asia (excluding high income)" = "Europa & √Åsia Central (exceto alto rendimento)",
    "Europe & Central Asia" = "Europa & √Åsia Central",
    "Euro √°rea" = "√Årea do Euro",
    "Central Europe and the Baltics" = "Europa Central & B√°lticos",
    "Armenia" = "Arm√™nia",
    "Argentina" = "Argentina",
    "Antigua and Barbuda" = "Ant√≠gua & Barbuda",
    "Andorra" = "Andorra",
    "Algeria" = "Arg√©lia",
    "Alb√¢nia" = "Alb√¢nia",
    "Brazil" = "Brasil",
    "Low Income" = "Baixa Renda",
    "Guinea-Bissau" = "Guin√©-Bissau",
    "Madagascar" = "Madagascar",
    "Mozambique" = "Mo√ßambique",
    "Sierra Leone" = "Serra Leoa",
    "Liberia" = "Lib√©ria",
    "Congo Dem. Rep." = "Rep. Dem. do Congo",
    "Burkina Faso" = "Burkina Faso",
    "Papua New Guinea" = "Papua Nova Guin√©",
    "Niger" = "N√≠ger",
    "Central African Republic" = "Rep. Centro-Africana",
    "Malawi" = "Malawi",
    "Chad" = "Chade",
    "Burundi" = "Burundi",
    "South Sudan" = "Sud√£o do Sul",
    .default = country  # Caso algum pa√≠s n√£o esteja listado, mantemos o nome original
  ))

ggplot(data = elet30, aes(x = reorder(country_pt, EG.ELC.ACCS.ZS), 
                          y = EG.ELC.ACCS.ZS, 
                          fill = status_eletricidade)) +
  geom_col(width = 0.7, alpha = 0.9) +
  geom_text(aes(label = paste0(round(EG.ELC.ACCS.ZS, 1), "%")),
            hjust = -0.2,
            size = 4,
            family = "Arial",
            color = "black") +
  scale_fill_manual(
    values = c("Brasil" = "red", 
               "100% de Acesso" = "#457B9D", 
               "Acesso Parcial" = "#A8DADC"),
    name = "Status de Acesso"
  ) +
  labs(
    title = "üîå Acesso √† Eletricidade em 30 Pa√≠ses (2023)",
    subtitle = "Brasil em destaque. Compara√ß√£o entre pa√≠ses com 100% e com acesso parcial.",
    x = NULL,
    y = "Acesso √† Eletricidade (% da Popula√ß√£o)",
    caption = "Fonte: Banco Mundial | Elabora√ß√£o pr√≥pria"
  ) +
  scale_y_continuous(
    limits = c(0, 105),
    breaks = seq(0, 100, 10),
    labels = function(x) paste0(x, "%"),
    expand = expansion(mult = c(0, 0.05))
  ) +
  coord_flip() +
  theme_minimal(base_family = "Arial") +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5, color = "#1D3557"),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "#457B9D"),
    plot.caption = element_text(size = 10, hjust = 1, color = "gray50"),
    axis.title.y = element_text(size = 10, margin = margin(r = 10)),
    axis.title.x = element_text(size = 10, margin = margin(t = 10)),
    axis.text.x = element_text(size = 6, color = "gray30"),  # Diminui o tamanho da fonte do eixo X
    axis.text.y = element_text(size = 8, color = "gray30"),  # Diminui o tamanho da fonte do eixo Y
    legend.title = element_text(size = 8),
    legend.text = element_text(size = 6),
    panel.grid.major.x = element_line(color = "gray80", linetype = "dashed"),
    panel.grid.minor = element_blank(),
    plot.background = element_rect(fill = "white", color = NA)
  )


```

## GR√ÅFICO DE DADOS DE S√âRIE TEMPORAL

O gr√°fico mostra a evolu√ß√£o do acesso √† eletricidade no Brasil entre 1990 e 2023.

Em 1990, cerca de 87,5% da popula√ß√£o brasileira tinha acesso √† eletricidade. A partir da√≠, observa-se um crescimento cont√≠nuo e expressivo:

-   Em 2000, o √≠ndice subiu para aproximadamente 94%;

-   Em 2010, atingiu cerca de 98,5%;

-   Em 2020 e 2023, o acesso ultrapassou os 99,5%, beirando a universaliza√ß√£o.

Esse progresso reflete avan√ßos significativos em pol√≠ticas p√∫blicas, programas de eletrifica√ß√£o rural e expans√£o da infraestrutura energ√©tica no pa√≠s, especialmente nas d√©cadas de 1990 e 2000. A estabiliza√ß√£o dos dados pr√≥ximos a 100% nas √∫ltimas duas d√©cadas indica que o Brasil praticamente universalizou o acesso √† eletricidade, embora ainda possa haver desafios residuais em regi√µes muito isoladas.

```{r}
#| label: graficoserietemporal
#| warning: false  
#| echo: false    


 # Filtrar os anos desejados
 eletbr_filtrado <- eletbr |>
   filter(year %in% c(1990, 2000, 2010, 2020, 2023))
 
 # Criar o gr√°fico
 ggplot(data = eletbr_filtrado, aes(x = factor(year), y = EG.ELC.ACCS.ZS, group = 1)) +
   geom_line(color = "#E63946", size = 1.5) +  # Linha com cor personalizada
   geom_point(color = "#1D3557", size = 3) +   # Pontinhos nos anos
   labs(
     title = "Acesso √† Eletricidade no Brasil (1990‚Äì2023)",
     x = "Ano",
     y = "Acesso √† eletricidade (% da popula√ß√£o)"
   ) +
   theme_minimal(base_family = "Arial") +
   theme(
     plot.title = element_text(size = 18, face = "bold", hjust = 0.5, color = "#1D3557"),
     axis.title.x = element_text(size = 14, face = "bold"),
     axis.title.y = element_text(size = 14, face = "bold"),
     axis.text = element_text(size = 12),
     panel.grid.major = element_line(color = "gray90"),
     panel.grid.minor = element_blank()
   )
 
```
